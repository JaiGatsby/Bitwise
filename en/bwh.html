<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta name="robots" content="noindex, nofollow">
		<meta name="googlebot" content="noindex, nofollow">
		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<title> Individual Engagement Level Visualizer	</title>
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" type="text/css" href="/css/result-light.css">
		<link rel="stylesheet" type="text/css" href="..\css\data.css">
		<style>
				div{
				padding-right: 800px;
				padding-bottom: 20px;
				padding-left: 0px;
				padding-top: 450px;
			}	
		</style>	
		<script>
$(document).ready(function(){
$(function () {
    $('#container').highcharts({
        chart : {
			type: 'spline'
				,
            events : {
                load : function () {

                    // set up the updating of the chart each second
                    var series = this.series[0];
                    setInterval(function () {
                        var x = (new Date()).getTime(), // current time
                            y = Math.round(Math.random() % 150);
                        series.addPoint([x, y], true, true);
                    }, 20000);
                }
            }
        },
		rangeSelector: {
            buttons: [{
                count: 1,
                type: 'minute',
                text: '1M'
            }, {
                count: 5,
                type: 'minute',
                text: '5M'
            }, {
                type: 'all',
                text: 'All'
            }],
            inputEnabled: false,
            selected: 0
        },
        title: {
            text: 'Individual Engagement Level'
        },
        subtitle: {
            
        },
        xAxis: {
            type: 'time',
            labels: {
                overflow: 'justify'
            }
        },
        yAxis: {
            title: {
                text: 'engagement level'
            },
            minorGridLineWidth: 0,
            gridLineWidth: 0,
            alternateGridColor: null,
            plotBands: [
			{ 
                from: 0.3,
                to: 50.5,
                color: '#4dffb8',
                label: {
                    text: 'deeply engaged',
                    style: {
                        color: '#FFFFFF'
                    }
                }
            }, { 
                from: 50.5,
                to: 100.3,
                color: '#ffff66',
                label: {
                    text: 'engaged',
                    style: {
                        color: '#FFFFFF'
                    }
                }
            }, { 
                from: 100.3,
                to: 150.5,
                color: '#ff5050',
                label: {
                    text: 'zoned out',
                    style: {
                        color: '#FFFFFF'
                    }
                }
            }]
        },
		        exporting: {
            enabled: false
        },

        plotOptions: {
            spline: {
                lineWidth: 2,
                states: {
                    hover: {
                        lineWidth: 2
                    }
                },
                marker: {
                    enabled: false
                },
                pointInterval: 360000, // one hour
                pointStart: Date.UTC(2015, 4, 31, 0, 0, 0)
            }
        },
        series : [{
            name : 'Random data',
            data : (function () {
                // generate an array of random data
                var data = [], time = (new Date()).getTime(), i;

                for (i = -999; i <= 0; i += 1) {
                    data.push([
                        time + i * 1000,
                        Math.round(Math.random() * 100)
                    ]);
                }
                return data;
            }())
        }],
        navigation: {
            menuItemStyle: {
                fontSize: '10px'
            }
        }
    });
});
});
	

	</script>
	<!--
	series: [{
            name: 'Breathing',
            data: (function () {                
                var tempARR= [];
				var arraySize=updateArray.length;
				var time = (new Date()).getTime();
				setInterval(function(){realTimePush()},1000);
				realTimePush(){
					for (var i=0; i<arraySize;i++){
						tempARR[i]=updateArray[i];
						data.push([
                        time,tempARR[i] )
                    ]);
					}
				}
                
                }
                return data;
            }())
			
        }, {
            name: 'Blood pressure',
            data: [0, 0, 0.6, 0.9, 0.8, 0.2, 0, 0, 0, 0.1, 0.6, 0.7, 0.8, 0.6, 0.2, 0, 0.1, 0.3, 0.3, 0, 0.1, 0, 0, 0, 0.2, 0.1, 0, 0.3, 0, 0.1, 0.2, 0.1, 0.3, 0.3, 0, 3.1, 3.1, 2.5, 1.5, 1.9, 2.1, 1, 2.3, 1.9, 1.2, 0.7, 1.3, 0.4, 0.3]
			}],
	-->
	</head>
	<body background="..\Pictures/account.png">

	<!--
	data: studentName, studentIcon, graph, graphAxis
	get student ID: 	obj.device.id 
	get sensor value: 	obj.values.tilt.value
	get data timestamp:	obj.values.tilt.timestamp
						var text={JSON text};
						var obj=JSON=parse(text);
	
	1/ get data as json
	2/ extract id,sensor value, time stamp from json
	3/ stores the value at array[id] :push
	4/ users access either individual+class average (parents) OR all students and class average (teachers)
	-->
		
		
		<script src="https://code.highcharts.com/highcharts.js"></script>
		<script src="https://code.highcharts.com/modules/exporting.js"></script>

		<div id="container" style="min-width: 210px; max-width:800px; height: 400px; margin: 0 auto"></div>
			
		<!--
		<div>
		<img src="http://api-m2x.att.com/v2/charts/3d103c7751acf193807d672d7e651c61.png?width=800&height=600&type=values" alt="graph" id="engagementGraph"/>
		</div>
		-->
		
		<!--
		<script>
		$(document).ready(function(){
			function getData(){
				$.getJSON('JSONname',function(obj)
					for (var i in obj){
						var studentID= obj[i].device.id;
						var engagement=obj[i].values.tilt.value;
					}
					var output = "<ul>";
					for(var i in data){
						output+= "<li>"+studentID+"--"+engagement;
					}
					output+="</ul>";					
				)}
			$(function(){
				getData();			
			})
		});		
		</script>
		-->
		
		<!--
		function create2DArray(rowNum){
				var engagementARR=[];
				for(var i=0; i<rowNum;i++){
					engagementARR[i]=[];
				}
			}
		-->
		
		<a href="getdata.html" ><h1 id="testButton">click me</h1></a>
		<!--
		<script>
			function f1(){
				jsonArray= [0, 0, 0.6, 0.9, 0.8, 0.2, 0, 0, 0, 0.1, 0.6, 0.7, 0.8, 0.6, 0.2, 0, 0.1, 0.3, 0.3, 0, 0.1, 0, 0, 0, 0.2, 0.1, 0, 0.3, 0, 0.1, 0.2, 0.1, 0.3, 0.3, 0, 3.1, 3.1, 2.5, 1.5, 1.9, 2.1, 1, 2.3, 1.9, 1.2, 0.7, 1.3, 0.4, 0.3];
				console.log("f1:array changed. check graph")
			}
			window.onload=function(){
				document.getElementById("testButton").onclick=function f2(){
					alert("array updated");
					f1();
				}
			}
		</script>
		-->
		
		<script>
		var jsonArray=[];
		var updateArray=[];
		jsonArray= [0.2, 0.8, 0.8, 0.8, 1, 1.3, 1.5, 2.9, 1.9, 2.6, 1.6, 3, 4, 3.6, 4.5, 4.2, 4.5, 4.5, 4, 3.1, 2.7, 4, 2.7, 2.3, 2.3, 4.1, 7.7, 7.1, 5.6, 6.1, 5.8, 8.6, 7.2, 9, 10.9, 11.5, 11.6, 11.1, 12, 12.3, 10.7, 9.4, 9.8, 9.6, 9.8, 9.5, 8.5, 7.4, 7.6];
		Array.observe(jsonArray,function(changes){
			var arraySize=jsonArray.length;
			jsonArray.shift();
			jsonArray.reverse();
			for (var i=0; i<arraySize;i++){
				updateArray[i]=jsonArray[i];
			}
			console.log(updateArray);
		});	
		</script>
		
		<script>		
			<!--update the chart with setInterval, and new Series array-->
			setInterval(function(){graphUpdate()},1000);
			function graphUpdate(){
				container.series[0].update({
					pointStart: updateArray[0].pointStart,
					data: updateArray[0].data
					}, true); 
			}
		</script>
		

			
		<!--
		PLAN C: EMBEDDED IMAGE
			1 sec timeout
			d= new Date();
			setInterval(function(){counterUpdate()},1000);
			function counterUpdate(){				
				var yyyy=d.getFullYear();
				var mm=d.getMonth();
				var dd=d.getDate();
				var hh=d.getHours();
				var mm=d.getMinutes();
				var ss=d.getSeconds();				
				console.log(yyyy);
				console.log(mm);
				console.log(dd);
				console.log(hh);
				console.log(mm);
				console.log(ss);				
				var imageElement=document.getElementById('engagementGraph');
				engagementGraph.src='http://api-m2x.att.com/v2/charts/3d103c7751acf193807d672d7e651c61.png?width=800&height=600&type=values&start='+yyyy+'-'+mm+'-'+dd+'T'+hh+'%3A'+mm+'%3A'+ss+'.000Z';
			}
		-->
		
		
	</body>
	
</html>